<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数字泡泡膜解压神器 - AI工具集</title>
    <meta name="description" content="数字泡泡膜解压神器">
    
    <!-- 样式文件 -->
    <link rel="stylesheet" href="../../shared/css/common.css">
    
    <!-- 工具特定样式 -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            padding: var(--spacing-lg);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            color: white;
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .bubble-icon {
            width: 40px;
            height: 40px;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), rgba(255,255,255,0.3), transparent);
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.5);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .stats-panel {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: var(--spacing-md) 20px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-number {
            font-size: 1.5em;
            color: #FFD700;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: var(--spacing-lg) 0;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .control-btn.active {
            background: #FFD700;
            color: var(--text-primary);
            border-color: #FFD700;
        }

        .bubble-container {
            padding: var(--spacing-lg);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 5px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .bubble {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: all 0.1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
            color: var(--text-primary);
            text-shadow: 0 1px 2px rgba(255,255,255,0.5);
        }

        .bubble.intact {
            background: radial-gradient(circle at 30% 30%, 
                rgba(255,255,255,0.9), 
                rgba(255,255,255,0.7), 
                rgba(255,255,255,0.5));
            border: 2px solid rgba(255,255,255,0.8);
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.1),
                inset 0 2px 4px rgba(255,255,255,0.8),
                inset 0 -2px 4px rgba(0,0,0,0.1);
        }

        .bubble.intact:hover {
            transform: scale(1.1);
            box-shadow: 
                0 6px 12px rgba(0,0,0,0.2),
                inset 0 2px 4px rgba(255,255,255,0.9),
                inset 0 -2px 4px rgba(0,0,0,0.1);
        }

        .bubble.intact:active {
            transform: scale(0.95);
        }

        .bubble.popped {
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            border: 2px solid #ccc;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            cursor: default;
            color: var(--text-muted);
            transform: scale(0.8);
        }

        .bubble.popping {
            animation: pop 0.3s ease-out;
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(0.8); }
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #FFD700;
            border-radius: 50%;
            pointer-events: none;
            animation: particle-burst 0.6s ease-out forwards;
        }

        @keyframes particle-burst {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0) translate(var(--dx), var(--dy));
            }
        }

        .achievement {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: var(--text-primary);
            padding: var(--spacing-lg) 30px;
            border-radius: var(--radius-lg);
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            animation: achievement-show 2s ease-out forwards;
            border: 3px solid #FF6B35;
        }

        @keyframes achievement-show {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .sound-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .footer {
            text-align: center;
            padding: 30px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .bubble-container {
                grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
                gap: 3px;
            }
            
            .bubble {
                width: 50px;
                height: 50px;
                font-size: 0.8em;
            }
            
            .stats-panel {
                gap: 15px;
            }
            
            .stat-item {
                padding: 8px 16px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <!-- 工具头部 -->
        <header class="tool-header">
            <div class="tool-header-content">
                <a href="../../index.html" class="back-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M10 4l-4 4 4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    返回工具集
                </a>
                
                <div class="tool-title">
                    <h1>数字泡泡膜解压神器</h1>
                    <p class="tool-subtitle">数字泡泡膜解压神器</p>
                </div>
                
                <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2"/>
                        <path d="M10 2v2M10 16v2M18 10h-2M4 10H2M15.66 4.34l-1.41 1.41M5.75 14.25l-1.41 1.41M15.66 15.66l-1.41-1.41M5.75 5.75L4.34 4.34" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- 工具主内容 -->
        <main class="tool-main">
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        工具功能
                    </h2>
                    
                    
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        数字泡泡膜解压神器
                    </h2>
                    <div class="container">
                        <div class="header">
        <h1>
            <div class="bubble-icon"></div>
            数字泡泡膜解压神器
            <div class="bubble-icon"></div>
        </h1>
        <p style="color: rgba(255,255,255,0.9); margin-top: 10px;">点击泡泡释放压力，享受治愈时光</p>
        
        <div class="stats-panel">
            <div class="stat-item">
                已捏爆: <span class="stat-number" id="poppedCount">0</span>
            </div>
            <div class="stat-item">
                剩余: <span class="stat-number" id="remainingCount">0</span>
            </div>
            <div class="stat-item">
                连击: <span class="stat-number" id="comboCount">0</span>
            </div>
            <div class="stat-item">
                最高连击: <span class="stat-number" id="maxCombo">0</span>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn" id="resetBtn">🔄 重新开始</button>
            <button class="control-btn" id="sizeBtn" data-size="normal">📏 普通模式</button>
            <button class="control-btn" id="speedBtn" data-speed="normal">⚡ 普通速度</button>
            <button class="control-btn" id="numberBtn" data-show="true">🔢 显示数字</button>
        </div>
    </div>

    <div class="sound-toggle" id="soundToggle" title="音效开关">
        🔊
    </div>

    <div class="bubble-container" id="bubbleContainer">
        <!-- 泡泡将由JavaScript生成 -->
    </div>

    <div class="footer">
        <p>© 小苏趣研AI 数字泡泡膜解压神器 | 让压力随泡泡一起消失</p>
    </div>

    
                    </div>
                </div>
            </div>
                    <!-- 结果显示区域 -->
                    <div class="result-display" id="result">
                        <pre id="resultContent">处理结果将在这里显示...</pre>
                    </div>
                </div>
            </div>
        </main>

        <!-- 工具页脚 -->
        <footer class="tool-footer">
            <p>由 <a href="../../index.html">AI工具集</a> 提供 | 原创工具</p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="../../shared/js/utils.js"></script>
    <script>
        // 工具特定的JavaScript代码
        class ToolApp {
            constructor() {
                this.init();
            }

            init() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.getElementById('processBtn').addEventListener('click', () => this.process());
                document.getElementById('clearBtn').addEventListener('click', () => this.clear());
                document.getElementById('copyBtn').addEventListener('click', () => this.copyResult());
                
                // 实时处理（可选）
                document.getElementById('input').addEventListener('input', 
                    ToolUtils.debounce(() => this.process(), 300)
                );
            }

            process() {
                const input = document.getElementById('input').value;
                const result = this.processInput(input);
                this.displayResult(result);
            }

            processInput(input) {
                
        class BubbleWrapGame {
            constructor() {
                this.bubbleContainer = document.getElementById('bubbleContainer');
                this.poppedCountEl = document.getElementById('poppedCount');
                this.remainingCountEl = document.getElementById('remainingCount');
                this.comboCountEl = document.getElementById('comboCount');
                this.maxComboEl = document.getElementById('maxCombo');
                
                this.poppedCount = 0;
                this.totalBubbles = 0;
                this.combo = 0;
                this.maxCombo = 0;
                this.comboTimer = null;
                this.soundEnabled = true;
                this.showNumbers = true;
                this.bubbleSize = 'normal';
                this.popSpeed = 'normal';
                
                this.achievements = [
                    { count: 10, message: '🎉 初次体验！捏爆了10个泡泡！' },
                    { count: 50, message: '🔥 小有成就！捏爆了50个泡泡！' },
                    { count: 100, message: '💯 百发百中！捏爆了100个泡泡！' },
                    { count: 200, message: '🚀 泡泡杀手！捏爆了200个泡泡！' },
                    { count: 500, message: '👑 泡泡大师！捏爆了500个泡泡！' }
                ];
                
                this.initializeBubbles();
                this.bindEvents();
                this.loadSettings();
            }

            initializeBubbles() {
                this.bubbleContainer.innerHTML = '';
                this.poppedCount = 0;
                this.combo = 0;
                
                // 根据屏幕大小计算泡泡数量
                const containerWidth = this.bubbleContainer.offsetWidth;
                const bubbleWidth = this.bubbleSize === 'small' ? 50 : this.bubbleSize === 'large' ? 80 : 60;
                const bubblesPerRow = Math.floor(containerWidth / (bubbleWidth + 5));
                const rows = this.bubbleSize === 'small' ? 20 : this.bubbleSize === 'large' ? 12 : 15;
                
                this.totalBubbles = bubblesPerRow * rows;
                
                // 更新CSS变量
                document.documentElement.style.setProperty('--bubble-size', bubbleWidth + 'px');
                
                for (let i = 0; i < this.totalBubbles; i++) {
                    const bubble = this.createBubble(i + 1);
                    this.bubbleContainer.appendChild(bubble);
                }
                
                this.updateStats();
            }

            createBubble(number) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble intact';
                bubble.dataset.number = number;
                
                if (this.showNumbers) {
                    bubble.textContent = number;
                }
                
                // 设置泡泡大小
                const size = this.bubbleSize === 'small' ? '50px' : 
                           this.bubbleSize === 'large' ? '80px' : '60px';
                bubble.style.width = size;
                bubble.style.height = size;
                
                bubble.addEventListener('click', (e) => this.popBubble(e.target));
                
                return bubble;
            }

            popBubble(bubble) {
                if (bubble.classList.contains('popped')) return;
                
                bubble.classList.remove('intact');
                bubble.classList.add('popping');
                
                // 播放音效
                this.playPopSound();
                
                // 创建粒子效果
                this.createParticles(bubble);
                
                // 更新计数
                this.poppedCount++;
                this.combo++;
                
                // 重置连击计时器
                clearTimeout(this.comboTimer);
                this.comboTimer = setTimeout(() => {
                    this.combo = 0;
                    this.updateStats();
                }, 2000);
                
                // 更新最高连击
                if (this.combo > this.maxCombo) {
                    this.maxCombo = this.combo;
                }
                
                // 检查成就
                this.checkAchievements();
                
                // 延迟设置为已爆状态
                setTimeout(() => {
                    bubble.classList.remove('popping');
                    bubble.classList.add('popped');
                    bubble.textContent = '💥';
                }, this.popSpeed === 'fast' ? 150 : this.popSpeed === 'slow' ? 450 : 300);
                
                this.updateStats();
                
                // 检查是否全部完成
                if (this.poppedCount === this.totalBubbles) {
                    setTimeout(() => {
                        this.showAchievement('🎊 恭喜！所有泡泡都被捏爆了！');
                    }, 500);
                }
            }

            createParticles(bubble) {
                const rect = bubble.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                
                for (let i = 0; i < 8; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    
                    const angle = (i / 8) * Math.PI * 2;
                    const distance = 50 + Math.random() * 30;
                    const dx = Math.cos(angle) * distance;
                    const dy = Math.sin(angle) * distance;
                    
                    particle.style.left = centerX + 'px';
                    particle.style.top = centerY + 'px';
                    particle.style.setProperty('--dx', dx + 'px');
                    particle.style.setProperty('--dy', dy + 'px');
                    
                    document.body.appendChild(particle);
                    
                    setTimeout(() => {
                        particle.remove();
                    }, 600);
                }
            }

            playPopSound() {
                if (!this.soundEnabled) return;
                
                // 创建音频上下文播放泡泡音效
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(800 + Math.random() * 400, audioContext.currentTime);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            }

            checkAchievements() {
                const achievement = this.achievements.find(a => a.count === this.poppedCount);
                if (achievement) {
                    this.showAchievement(achievement.message);
                }
                
                // 连击成就
                if (this.combo === 10) {
                    this.showAchievement('⚡ 连击达人！连续捏爆10个泡泡！');
                } else if (this.combo === 20) {
                    this.showAchievement('🔥 连击狂魔！连续捏爆20个泡泡！');
                } else if (this.combo === 50) {
                    this.showAchievement('💫 连击传说！连续捏爆50个泡泡！');
                }
            }

            showAchievement(message) {
                const achievement = document.createElement('div');
                achievement.className = 'achievement';
                achievement.textContent = message;
                document.body.appendChild(achievement);
                
                setTimeout(() => {
                    achievement.remove();
                }, 2000);
            }

            updateStats() {
                this.poppedCountEl.textContent = this.poppedCount;
                this.remainingCountEl.textContent = this.totalBubbles - this.poppedCount;
                this.comboCountEl.textContent = this.combo;
                this.maxComboEl.textContent = this.maxCombo;
            }

            bindEvents() {
                // 重新开始按钮
                document.getElementById('resetBtn').addEventListener('click', () => {
                    this.initializeBubbles();
                });
                
                // 大小切换
                document.getElementById('sizeBtn').addEventListener('click', (e) => {
                    const sizes = ['normal', 'small', 'large'];
                    const sizeNames = ['📏 普通模式', '📐 迷你模式', '📊 大号模式'];
                    const currentIndex = sizes.indexOf(this.bubbleSize);
                    const nextIndex = (currentIndex + 1) % sizes.length;
                    
                    this.bubbleSize = sizes[nextIndex];
                    e.target.textContent = sizeNames[nextIndex];
                    this.initializeBubbles();
                });
                
                // 速度切换
                document.getElementById('speedBtn').addEventListener('click', (e) => {
                    const speeds = ['normal', 'fast', 'slow'];
                    const speedNames = ['⚡ 普通速度', '🚀 快速模式', '🐌 慢速模式'];
                    const currentIndex = speeds.indexOf(this.popSpeed);
                    const nextIndex = (currentIndex + 1) % speeds.length;
                    
                    this.popSpeed = speeds[nextIndex];
                    e.target.textContent = speedNames[nextIndex];
                });
                
                // 数字显示切换
                document.getElementById('numberBtn').addEventListener('click', (e) => {
                    this.showNumbers = !this.showNumbers;
                    e.target.textContent = this.showNumbers ? '🔢 显示数字' : '🔢 隐藏数字';
                    e.target.classList.toggle('active', this.showNumbers);
                    this.initializeBubbles();
                });
                
                // 音效切换
                document.getElementById('soundToggle').addEventListener('click', (e) => {
                    this.soundEnabled = !this.soundEnabled;
                    e.target.textContent = this.soundEnabled ? '🔊' : '🔇';
                    this.saveSettings();
                });
                
                // 窗口大小改变时重新初始化
                window.addEventListener('resize', () => {
                    clearTimeout(this.resizeTimer);
                    this.resizeTimer = setTimeout(() => {
                        this.initializeBubbles();
                    }, 300);
                });
                
                // 键盘快捷键
                document.addEventListener('keydown', (e) => {
                    switch(e.key) {
                        case 'r':
                        case 'R':
                            this.initializeBubbles();
                            break;
                        case 's':
                        case 'S':
                            this.soundEnabled = !this.soundEnabled;
                            document.getElementById('soundToggle').textContent = this.soundEnabled ? '🔊' : '🔇';
                            break;
                    }
                });
            }

            saveSettings() {
                const settings = {
                    soundEnabled: this.soundEnabled,
                    showNumbers: this.showNumbers,
                    bubbleSize: this.bubbleSize,
                    popSpeed: this.popSpeed,
                    maxCombo: this.maxCombo
                };
                localStorage.setItem('bubbleWrapSettings', JSON.stringify(settings));
            }

            loadSettings() {
                const saved = localStorage.getItem('bubbleWrapSettings');
                if (saved) {
                    const settings = JSON.parse(saved);
                    this.soundEnabled = settings.soundEnabled ?? true;
                    this.showNumbers = settings.showNumbers ?? true;
                    this.bubbleSize = settings.bubbleSize ?? 'normal';
                    this.popSpeed = settings.popSpeed ?? 'normal';
                    this.maxCombo = settings.maxCombo ?? 0;
                    
                    // 更新UI
                    document.getElementById('soundToggle').textContent = this.soundEnabled ? '🔊' : '🔇';
                    document.getElementById('numberBtn').classList.toggle('active', this.showNumbers);
                    this.updateStats();
                }
            }
        }

        // 初始化游戏
        document.addEventListener('DOMContentLoaded', () => {
            new BubbleWrapGame();
        });
    
                return input;
            }

            displayResult(result) {
                document.getElementById('resultContent').textContent = result;
            }

            clear() {
                document.getElementById('input').value = '';
                document.getElementById('resultContent').textContent = '处理结果将在这里显示...';
            }

            copyResult() {
                const result = document.getElementById('resultContent').textContent;
                if (result && result !== '处理结果将在这里显示...') {
                    ToolUtils.copyToClipboard(result);
                } else {
                    ToolUtils.showToast('没有可复制的内容', 'warning');
                }
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            new ToolApp();
        });
    </script>
</body>
</html>
