<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>打字速度测试 - Typing Speed Test - AI工具集</title>
    <meta name="description" content="打字速度测试 - Typing Speed Test">
    
    <!-- 样式文件 -->
    <link rel="stylesheet" href="../../shared/css/common.css">
    
    <!-- 工具特定样式 -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: var(--spacing-lg);
            color: var(--text-primary);
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            text-align: center;
            padding: 40px 20px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .test-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-item {
            background: #f8f9fa;
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            text-align: center;
            border-left: 5px solid #4ecdc4;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .test-area {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }

        .test-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 14px;
            font-weight: bold;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .control-btn.active {
            background: var(--text-primary);
        }

        .timer-display {
            text-align: center;
            font-size: 3em;
            font-weight: bold;
            color: #4ecdc4;
            margin-bottom: 20px;
        }

        .text-display {
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: var(--radius-lg);
            padding: 30px;
            font-size: 18px;
            line-height: 1.8;
            margin-bottom: 20px;
            min-height: 200px;
            position: relative;
        }

        .text-display.active {
            border-color: #4ecdc4;
        }

        .char {
            position: relative;
        }

        .char.correct {
            background: #d4edda;
            color: #155724;
        }

        .char.incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .char.current {
            background: #4ecdc4;
            color: white;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .typing-input {
            width: 100%;
            padding: var(--spacing-lg);
            border: 3px solid #e0e0e0;
            border-radius: var(--radius-lg);
            font-size: 18px;
            font-family: 'Courier New', monospace;
            line-height: 1.8;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
        }

        .typing-input:focus {
            border-color: #4ecdc4;
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.2);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            width: 0%;
            transition: width 0.3s ease;
        }

        .result-section {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-top: 20px;
            display: none;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .result-item {
            text-align: center;
            padding: var(--spacing-lg);
            background: #f8f9fa;
            border-radius: var(--radius-md);
        }

        .result-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #4ecdc4;
            margin-bottom: 10px;
        }

        .result-label {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .footer {
            text-align: center;
            padding: var(--spacing-lg);
            color: var(--text-secondary);
            font-size: 14px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-md);
                margin: var(--spacing-sm);
            }
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <!-- 工具头部 -->
        <header class="tool-header">
            <div class="tool-header-content">
                <a href="../../index.html" class="back-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M10 4l-4 4 4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    返回工具集
                </a>
                
                <div class="tool-title">
                    <h1>打字速度测试 - Typing Speed Test</h1>
                    <p class="tool-subtitle">打字速度测试 - Typing Speed Test</p>
                </div>
                
                <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2"/>
                        <path d="M10 2v2M10 16v2M18 10h-2M4 10H2M15.66 4.34l-1.41 1.41M5.75 14.25l-1.41 1.41M15.66 15.66l-1.41-1.41M5.75 5.75L4.34 4.34" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- 工具主内容 -->
        <main class="tool-main">
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        工具功能
                    </h2>
                    
                    
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        打字速度测试 - Typing Speed Test
                    </h2>
                    <div class="container">
        <div class="header">
            <h1>⌨️ 打字速度测试</h1>
            <p>测试你的打字速度和准确率，提升键盘技能</p>
        </div>

        <div class="content">
            <div class="test-stats">
                <div class="stat-item">
                    <div class="stat-number" id="currentWPM">0</div>
                    <div class="stat-label">当前WPM</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="currentAccuracy">100%</div>
                    <div class="stat-label">当前准确率</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="bestWPM">0</div>
                    <div class="stat-label">最佳WPM</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="avgAccuracy">0%</div>
                    <div class="stat-label">平均准确率</div>
                </div>
            </div>

            <div class="test-area">
                <div class="test-controls">
                    <button class="control-btn active" onclick="setDuration(30)">30秒</button>
                    <button class="control-btn" onclick="setDuration(60)">1分钟</button>
                    <button class="control-btn" onclick="setDuration(120)">2分钟</button>
                    <button class="control-btn" onclick="setDuration(300)">5分钟</button>
                    <button class="control-btn" onclick="changeText()">换文章</button>
                    <button class="control-btn" onclick="resetTest()">重新开始</button>
                </div>

                <div class="timer-display" id="timerDisplay">30</div>

                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>

                <div class="text-display" id="textDisplay"></div>

                <textarea 
                    class="typing-input" 
                    id="typingInput" 
                    placeholder="点击这里开始打字测试..."
                    rows="6"></textarea>
            </div>

            <div class="result-section" id="resultSection">
                <h3 style="text-align: center; margin-bottom: 20px;">🎉 测试结果</h3>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="result-value" id="finalWPM">0</div>
                        <div class="result-label">每分钟字数 (WPM)</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value" id="finalAccuracy">0%</div>
                        <div class="result-label">准确率</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value" id="totalChars">0</div>
                        <div class="result-label">总字符数</div>
                    </div>
                    <div class="result-item">
                        <div class="result-value" id="correctChars">0</div>
                        <div class="result-label">正确字符</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>© 小苏趣研AI | 打字速度测试 - 学习教育类工具</p>
        </div>
    </div>

    
                </div>
            </div>
                    <!-- 结果显示区域 -->
                    <div class="result-display" id="result">
                        <pre id="resultContent">处理结果将在这里显示...</pre>
                    </div>
                </div>
            </div>
        </main>

        <!-- 工具页脚 -->
        <footer class="tool-footer">
            <p>由 <a href="../../index.html">AI工具集</a> 提供 | 原创工具</p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="../../shared/js/utils.js"></script>
    <script>
        // 工具特定的JavaScript代码
        class ToolApp {
            constructor() {
                this.init();
            }

            init() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.getElementById('processBtn').addEventListener('click', () => this.process());
                document.getElementById('clearBtn').addEventListener('click', () => this.clear());
                document.getElementById('copyBtn').addEventListener('click', () => this.copyResult());
                
                // 实时处理（可选）
                document.getElementById('input').addEventListener('input', 
                    ToolUtils.debounce(() => this.process(), 300)
                );
            }

            process() {
                const input = document.getElementById('input').value;
                const result = this.processInput(input);
                this.displayResult(result);
            }

            processInput(input) {
                
        class TypingSpeedTest {
            constructor() {
                this.texts = [
                    "The quick brown fox jumps over the lazy dog. This pangram contains every letter of the alphabet and is commonly used for typing practice.",
                    "In the digital age, typing skills have become essential for productivity and communication. Regular practice can significantly improve both speed and accuracy.",
                    "Programming requires not only logical thinking but also efficient typing skills. Developers who can type quickly can focus more on problem-solving rather than struggling with the keyboard.",
                    "Technology has revolutionized the way we work, learn, and communicate. From smartphones to artificial intelligence, innovation continues to shape our future.",
                    "Learning is a lifelong journey that never ends. Every day presents new opportunities to acquire knowledge, develop skills, and grow as individuals."
                ];
                
                this.currentText = '';
                this.currentIndex = 0;
                this.startTime = null;
                this.endTime = null;
                this.duration = 30;
                this.timer = null;
                this.isActive = false;
                this.correctChars = 0;
                this.totalChars = 0;
                
                this.bestWPM = parseInt(localStorage.getItem('bestWPM') || '0');
                this.testHistory = JSON.parse(localStorage.getItem('typingHistory') || '[]');
                
                this.initializeTest();
                this.updateStats();
            }

            initializeTest() {
                this.currentText = this.texts[Math.floor(Math.random() * this.texts.length)];
                this.displayText();
                this.resetInput();
            }

            displayText() {
                const display = document.getElementById('textDisplay');
                display.innerHTML = this.currentText.split('').map((char, index) => 
                    `<span class="char" data-index="${index}">${char}</span>`
                ).join('');
            }

            resetInput() {
                const input = document.getElementById('typingInput');
                input.value = '';
                input.disabled = false;
                input.focus();
                
                this.currentIndex = 0;
                this.correctChars = 0;
                this.totalChars = 0;
                this.isActive = false;
                this.startTime = null;
                this.endTime = null;
                
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                }
                
                document.getElementById('timerDisplay').textContent = this.duration;
                document.getElementById('progressFill').style.width = '0%';
                document.getElementById('resultSection').style.display = 'none';
                
                // 重置字符样式
                document.querySelectorAll('.char').forEach(char => {
                    char.className = 'char';
                });
                
                if (document.querySelectorAll('.char')[0]) {
                    document.querySelectorAll('.char')[0].classList.add('current');
                }
            }

            startTest() {
                if (this.isActive) return;
                
                this.isActive = true;
                this.startTime = Date.now();
                
                let timeLeft = this.duration;
                document.getElementById('timerDisplay').textContent = timeLeft;
                
                this.timer = setInterval(() => {
                    timeLeft--;
                    document.getElementById('timerDisplay').textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        this.endTest();
                    }
                }, 1000);
            }

            endTest() {
                this.isActive = false;
                this.endTime = Date.now();
                
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                }
                
                document.getElementById('typingInput').disabled = true;
                this.calculateResults();
                this.showResults();
            }

            handleInput(event) {
                const input = event.target.value;
                const chars = document.querySelectorAll('.char');
                
                if (!this.isActive && input.length > 0) {
                    this.startTest();
                }
                
                // 重置所有字符样式
                chars.forEach(char => {
                    char.className = 'char';
                });
                
                // 检查每个输入的字符
                for (let i = 0; i < input.length && i < this.currentText.length; i++) {
                    const char = chars[i];
                    if (input[i] === this.currentText[i]) {
                        char.classList.add('correct');
                    } else {
                        char.classList.add('incorrect');
                    }
                }
                
                // 设置当前字符
                if (input.length < this.currentText.length) {
                    chars[input.length].classList.add('current');
                }
                
                // 更新进度
                const progress = (input.length / this.currentText.length) * 100;
                document.getElementById('progressFill').style.width = Math.min(progress, 100) + '%';
                
                // 实时更新统计
                this.updateRealTimeStats(input);
                
                // 检查是否完成
                if (input.length >= this.currentText.length) {
                    this.endTest();
                }
            }

            updateRealTimeStats(input) {
                if (!this.isActive) return;
                
                const timeElapsed = (Date.now() - this.startTime) / 1000 / 60; // 分钟
                const correctChars = input.split('').filter((char, index) => 
                    char === this.currentText[index]
                ).length;
                
                const wpm = Math.round((correctChars / 5) / timeElapsed) || 0;
                const accuracy = input.length > 0 ? Math.round((correctChars / input.length) * 100) : 100;
                
                document.getElementById('currentWPM').textContent = wpm;
                document.getElementById('currentAccuracy').textContent = accuracy + '%';
            }

            calculateResults() {
                const input = document.getElementById('typingInput').value;
                const timeElapsed = this.duration / 60; // 分钟
                
                this.totalChars = input.length;
                this.correctChars = input.split('').filter((char, index) => 
                    char === this.currentText[index]
                ).length;
                
                const wpm = Math.round((this.correctChars / 5) / timeElapsed);
                const accuracy = this.totalChars > 0 ? Math.round((this.correctChars / this.totalChars) * 100) : 0;
                
                // 保存最佳成绩
                if (wpm > this.bestWPM) {
                    this.bestWPM = wpm;
                    localStorage.setItem('bestWPM', this.bestWPM.toString());
                }
                
                // 保存测试历史
                this.testHistory.push({ wpm, accuracy, date: new Date().toISOString() });
                if (this.testHistory.length > 10) {
                    this.testHistory.shift();
                }
                localStorage.setItem('typingHistory', JSON.stringify(this.testHistory));
                
                this.updateStats();
                
                return { wpm, accuracy };
            }

            showResults() {
                const { wpm, accuracy } = this.calculateResults();
                
                document.getElementById('finalWPM').textContent = wpm;
                document.getElementById('finalAccuracy').textContent = accuracy + '%';
                document.getElementById('totalChars').textContent = this.totalChars;
                document.getElementById('correctChars').textContent = this.correctChars;
                
                document.getElementById('resultSection').style.display = 'block';
                document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
            }

            updateStats() {
                document.getElementById('bestWPM').textContent = this.bestWPM;
                
                if (this.testHistory.length > 0) {
                    const avgAccuracy = Math.round(
                        this.testHistory.reduce((sum, test) => sum + test.accuracy, 0) / this.testHistory.length
                    );
                    document.getElementById('avgAccuracy').textContent = avgAccuracy + '%';
                } else {
                    document.getElementById('avgAccuracy').textContent = '0%';
                }
            }

            setDuration(seconds) {
                if (this.isActive) return;
                
                this.duration = seconds;
                document.getElementById('timerDisplay').textContent = seconds;
                
                // 更新按钮状态
                document.querySelectorAll('.control-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                event.target.classList.add('active');
            }

            changeText() {
                if (this.isActive) return;
                this.initializeTest();
            }

            resetTest() {
                this.resetInput();
            }
        }

        let typingTest;

        function setDuration(seconds) {
            typingTest.setDuration(seconds);
        }

        function changeText() {
            typingTest.changeText();
        }

        function resetTest() {
            typingTest.resetTest();
        }

        // 初始化
        window.onload = function() {
            typingTest = new TypingSpeedTest();
            
            document.getElementById('typingInput').addEventListener('input', function(e) {
                typingTest.handleInput(e);
            });
            
            // 防止粘贴
            document.getElementById('typingInput').addEventListener('paste', function(e) {
                e.preventDefault();
                alert('请手动输入，不要粘贴文本');
            });
        };
    
                return input;
            }

            displayResult(result) {
                document.getElementById('resultContent').textContent = result;
            }

            clear() {
                document.getElementById('input').value = '';
                document.getElementById('resultContent').textContent = '处理结果将在这里显示...';
            }

            copyResult() {
                const result = document.getElementById('resultContent').textContent;
                if (result && result !== '处理结果将在这里显示...') {
                    ToolUtils.copyToClipboard(result);
                } else {
                    ToolUtils.showToast('没有可复制的内容', 'warning');
                }
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            new ToolApp();
        });
    </script>
</body>
</html>
