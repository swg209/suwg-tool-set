<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图表生成器 - AI工具集</title>
    <meta name="description" content="图表生成器">
    
    <!-- 外部依赖 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"
    <!-- 样式文件 -->
    <link rel="stylesheet" href="../../shared/css/common.css">
    
    <!-- 工具特定样式 -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #1d1d1f;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 600;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.25rem;
            color: #86868b;
            font-weight: 400;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #1d1d1f;
        }

        .chart-type-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .chart-type-btn {
            padding: 12px 16px;
            border: 2px solid #e5e5e7;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
        }

        .chart-type-btn:hover {
            border-color: #007aff;
            transform: translateY(-2px);
        }

        .chart-type-btn.active {
            border-color: #007aff;
            background: #007aff;
            color: white;
        }

        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e5e7;
            border-radius: 12px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
        }

        .input-field:focus {
            outline: none;
            border-color: #007aff;
        }

        .data-input-area {
            min-height: 120px;
            resize: vertical;
            font-family: 'SF Mono', Monaco, monospace;
        }

        .btn {
            width: 100%;
            padding: 14px 24px;
            background: linear-gradient(135deg, #007aff 0%, #5856d6 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 16px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .download-btn {
            background: linear-gradient(135deg, #34c759 0%, #30d158 100%);
            margin-top: 12px;
        }

        .download-btn:hover {
            box-shadow: 0 8px 25px rgba(52, 199, 89, 0.3);
        }

        .example-data {
            font-size: 12px;
            color: #86868b;
            margin-top: 8px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
        }

        .chart-canvas {
            max-width: 100%;
            max-height: 400px;
        }

        .empty-state {
            text-align: center;
            color: #86868b;
        }

        .empty-state h3 {
            margin-bottom: 8px;
            font-size: 1.5rem;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .container {
                padding: var(--spacing-lg) 16px;
            }
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <!-- 工具头部 -->
        <header class="tool-header">
            <div class="tool-header-content">
                <a href="../../index.html" class="back-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M10 4l-4 4 4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    返回工具集
                </a>
                
                <div class="tool-title">
                    <h1>图表生成器</h1>
                    <p class="tool-subtitle">图表生成器</p>
                </div>
                
                <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2"/>
                        <path d="M10 2v2M10 16v2M18 10h-2M4 10H2M15.66 4.34l-1.41 1.41M5.75 14.25l-1.41 1.41M15.66 15.66l-1.41-1.41M5.75 5.75L4.34 4.34" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- 工具主内容 -->
        <main class="tool-main">
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        工具功能
                    </h2>
                    
                    
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        图表生成器
                    </h2>
                    <div class="container">
        <div class="header">
            <h1>图表生成器</h1>
            <p>输入数据，快速生成精美图表</p>
        </div>

        <div class="main-content">
            <div class="control-panel">
                <div class="form-group">
                    <label>选择图表类型</label>
                    <div class="chart-type-selector">
                        <button class="chart-type-btn active" data-type="bar">柱状图</button>
                        <button class="chart-type-btn" data-type="pie">饼图</button>
                        <button class="chart-type-btn" data-type="line">折线图</button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="chartTitle">图表标题</label>
                    <input type="text" id="chartTitle" class="input-field" placeholder="请输入图表标题">
                </div>

                <div class="form-group">
                    <label for="dataInput">数据输入</label>
                    <textarea id="dataInput" class="input-field data-input-area" placeholder="请输入数据，格式：标签,数值"></textarea>
                    <div class="example-data">
                        示例格式：<br>
                        苹果,30<br>
                        香蕉,25<br>
                        橙子,20<br>
                        葡萄,15
                    </div>
                </div>

                <button class="btn" onclick="generateChart()">生成图表</button>
                <button class="btn download-btn" onclick="downloadChart()" id="downloadBtn" style="display: none;">下载图表</button>
            </div>

            <div class="chart-container">
                <div class="empty-state" id="emptyState">
                    <h3>📊</h3>
                    <p>请输入数据并点击生成图表</p>
                </div>
                <canvas id="chartCanvas" class="chart-canvas" style="display: none;"></canvas>
            </div>
        </div>
    </div>

    
                </div>
            </div>
                    <!-- 结果显示区域 -->
                    <div class="result-display" id="result">
                        <pre id="resultContent">处理结果将在这里显示...</pre>
                    </div>
                </div>
            </div>
        </main>

        <!-- 工具页脚 -->
        <footer class="tool-footer">
            <p>由 <a href="../../index.html">AI工具集</a> 提供 | 原创工具</p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="../../shared/js/utils.js"></script>
    <script>
        // 工具特定的JavaScript代码
        class ToolApp {
            constructor() {
                this.init();
            }

            init() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.getElementById('processBtn').addEventListener('click', () => this.process());
                document.getElementById('clearBtn').addEventListener('click', () => this.clear());
                document.getElementById('copyBtn').addEventListener('click', () => this.copyResult());
                
                // 实时处理（可选）
                document.getElementById('input').addEventListener('input', 
                    ToolUtils.debounce(() => this.process(), 300)
                );
            }

            process() {
                const input = document.getElementById('input').value;
                const result = this.processInput(input);
                this.displayResult(result);
            }

            processInput(input) {
                
        let currentChart = null;
        let currentChartType = 'bar';

        // 图表类型选择
        document.querySelectorAll('.chart-type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.chart-type-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentChartType = this.dataset.type;
                updateExampleData();
            });
        });

        // 更新示例数据
        function updateExampleData() {
            const exampleData = document.querySelector('.example-data');
            const examples = {
                bar: '示例格式：<br>一月,30<br>二月,45<br>三月,35<br>四月,50',
                pie: '示例格式：<br>苹果,30<br>香蕉,25<br>橙子,20<br>葡萄,15',
                line: '示例格式：<br>1月,10<br>2月,20<br>3月,15<br>4月,25<br>5月,30'
            };
            exampleData.innerHTML = examples[currentChartType];
        }

        // 解析数据
        function parseData(dataText) {
            const lines = dataText.trim().split('\n');
            const labels = [];
            const data = [];

            lines.forEach(line => {
                const parts = line.split(',');
                if (parts.length >= 2) {
                    labels.push(parts[0].trim());
                    data.push(parseFloat(parts[1].trim()) || 0);
                }
            });

            return { labels, data };
        }

        // 生成图表
        function generateChart() {
            const dataInput = document.getElementById('dataInput').value;
            const chartTitle = document.getElementById('chartTitle').value || '图表';

            if (!dataInput.trim()) {
                alert('请输入数据');
                return;
            }

            const { labels, data } = parseData(dataInput);

            if (labels.length === 0) {
                alert('数据格式不正确，请检查输入');
                return;
            }

            // 销毁现有图表
            if (currentChart) {
                currentChart.destroy();
            }

            // 隐藏空状态，显示画布
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('chartCanvas').style.display = 'block';
            document.getElementById('downloadBtn').style.display = 'block';

            const ctx = document.getElementById('chartCanvas').getContext('2d');

            // 图表配置
            const config = {
                type: currentChartType,
                data: {
                    labels: labels,
                    datasets: [{
                        label: chartTitle,
                        data: data,
                        backgroundColor: generateColors(data.length, 0.8),
                        borderColor: generateColors(data.length, 1),
                        borderWidth: 2,
                        fill: currentChartType === 'line' ? false : true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: chartTitle,
                            font: {
                                size: 18,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: currentChartType === 'pie',
                            position: 'bottom'
                        }
                    },
                    scales: currentChartType === 'pie' ? {} : {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    }
                }
            };

            // 折线图特殊配置
            if (currentChartType === 'line') {
                config.data.datasets[0].tension = 0.4;
                config.data.datasets[0].pointBackgroundColor = '#007aff';
                config.data.datasets[0].pointBorderColor = '#007aff';
                config.data.datasets[0].pointRadius = 5;
            }

            currentChart = new Chart(ctx, config);
        }

        // 生成颜色
        function generateColors(count, alpha = 1) {
            const colors = [
                `rgba(0, 122, 255, ${alpha})`,
                `rgba(52, 199, 89, ${alpha})`,
                `rgba(255, 149, 0, ${alpha})`,
                `rgba(255, 59, 48, ${alpha})`,
                `rgba(88, 86, 214, ${alpha})`,
                `rgba(255, 204, 0, ${alpha})`,
                `rgba(175, 82, 222, ${alpha})`,
                `rgba(90, 200, 250, ${alpha})`
            ];

            const result = [];
            for (let i = 0; i < count; i++) {
                result.push(colors[i % colors.length]);
            }
            return result;
        }

        // 下载图表
        function downloadChart() {
            if (!currentChart) {
                alert('请先生成图表');
                return;
            }

            const canvas = document.getElementById('chartCanvas');
            const link = document.createElement('a');
            link.download = `chart_${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // 初始化示例数据
        updateExampleData();
    
                return input;
            }

            displayResult(result) {
                document.getElementById('resultContent').textContent = result;
            }

            clear() {
                document.getElementById('input').value = '';
                document.getElementById('resultContent').textContent = '处理结果将在这里显示...';
            }

            copyResult() {
                const result = document.getElementById('resultContent').textContent;
                if (result && result !== '处理结果将在这里显示...') {
                    ToolUtils.copyToClipboard(result);
                } else {
                    ToolUtils.showToast('没有可复制的内容', 'warning');
                }
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            new ToolApp();
        });
    </script>
</body>
</html>
