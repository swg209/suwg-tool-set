<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>货币转换器 - AI工具集</title>
    <meta name="description" content="货币转换器">
    
    <!-- 外部依赖 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"
    <!-- 样式文件 -->
    <link rel="stylesheet" href="../../shared/css/common.css">
    
    <!-- 工具特定样式 -->
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: var(--spacing-lg);
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--bg-card);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            padding: 30px;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
        }
        
        .converter-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input[type="number"] {
            width: 100%;
            padding: var(--spacing-md);
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        select {
            width: 100%;
            padding: var(--spacing-md);
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            background-color: white;
        }
        
        /* Select2自定义样式 */
        .select2-container {
            width: 100% !important;
        }
        
        .select2-container--default .select2-selection--single {
            height: 42px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 40px;
        }
        
        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background-color: #3498db;
        }
        
        .select2-dropdown {
            border: 1px solid #ddd;
        }
        
        .select2-search__field {
            padding: 8px !important;
            font-size: 16px !important;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: var(--spacing-md) 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
            grid-column: span 2;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border-left: 4px solid #3498db;
            display: none;
        }
        
        .result-amount {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .exchange-rate {
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .swap-btn {
            background-color: #2ecc71;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: var(--spacing-md) auto;
            grid-column: span 2;
        }
        
        .swap-btn:hover {
            background-color: #27ae60;
        }
        
        .loading {
            text-align: center;
            margin: var(--spacing-lg) 0;
            display: none;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            color: #e74c3c;
            background-color: #fadbd8;
            padding: var(--spacing-md);
            border-radius: 4px;
            margin-top: 20px;
            display: none;
        }
        
        .last-updated {
            text-align: right;
            color: #7f8c8d;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .popular-currencies {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        .currency-chip {
            background-color: #ecf0f1;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .currency-chip:hover {
            background-color: #d5dbdb;
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 14px;
            color: #7f8c8d;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-md);
                margin: var(--spacing-sm);
            }
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <!-- 工具头部 -->
        <header class="tool-header">
            <div class="tool-header-content">
                <a href="../../index.html" class="back-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M10 4l-4 4 4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    返回工具集
                </a>
                
                <div class="tool-title">
                    <h1>货币转换器</h1>
                    <p class="tool-subtitle">货币转换器</p>
                </div>
                
                <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2"/>
                        <path d="M10 2v2M10 16v2M18 10h-2M4 10H2M15.66 4.34l-1.41 1.41M5.75 14.25l-1.41 1.41M15.66 15.66l-1.41-1.41M5.75 5.75L4.34 4.34" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- 工具主内容 -->
        <main class="tool-main">
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        工具功能
                    </h2>
                    
                    
            <div class="tool-card">
                <div class="tool-section">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        货币转换器
                    </h2>
                    <div class="container">
        <h1>货币转换器</h1>
        
        <div class="converter-form">
            <div class="form-group">
                <label for="amount">金额</label>
                <input type="number" id="amount" min="0" step="0.01" value="1">
            </div>
            
            <div class="form-group">
                <label for="from-currency">从</label>
                <select id="from-currency"></select>
            </div>
            
            <button class="swap-btn" id="swap-btn">⇅</button>
            
            <div class="form-group">
                <label for="to-currency">到</label>
                <select id="to-currency"></select>
            </div>
            
            <button id="convert-btn">转换</button>
        </div>
        
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>正在获取最新汇率...</p>
        </div>
        
        <div class="error-message" id="error-message"></div>
        
        <div class="result" id="result">
            <div class="result-amount" id="result-amount"></div>
            <div class="exchange-rate" id="exchange-rate"></div>
            <div class="last-updated" id="last-updated"></div>
        </div>
        
        <div class="popular-currencies">
            <h3>常用货币:</h3>
            <div class="currency-chip" data-code="USD">美元 (USD)</div>
            <div class="currency-chip" data-code="EUR">欧元 (EUR)</div>
            <div class="currency-chip" data-code="JPY">日元 (JPY)</div>
            <div class="currency-chip" data-code="GBP">英镑 (GBP)</div>
            <div class="currency-chip" data-code="CNY">人民币 (CNY)</div>
            <div class="currency-chip" data-code="HKD">港币 (HKD)</div>
        </div>
        
        <div class="footer">
            <p>© 小苏趣研AI 货币转换器 | 使用实时汇率数据</p>
        </div>
    </div>

    
    
    
                </div>
            </div>
                    <!-- 结果显示区域 -->
                    <div class="result-display" id="result">
                        <pre id="resultContent">处理结果将在这里显示...</pre>
                    </div>
                </div>
            </div>
        </main>

        <!-- 工具页脚 -->
        <footer class="tool-footer">
            <p>由 <a href="../../index.html">AI工具集</a> 提供 | 原创工具</p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="../../shared/js/utils.js"></script>
    <script>
        // 工具特定的JavaScript代码
        class ToolApp {
            constructor() {
                this.init();
            }

            init() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.getElementById('processBtn').addEventListener('click', () => this.process());
                document.getElementById('clearBtn').addEventListener('click', () => this.clear());
                document.getElementById('copyBtn').addEventListener('click', () => this.copyResult());
                
                // 实时处理（可选）
                document.getElementById('input').addEventListener('input', 
                    ToolUtils.debounce(() => this.process(), 300)
                );
            }

            process() {
                const input = document.getElementById('input').value;
                const result = this.processInput(input);
                this.displayResult(result);
            }

            processInput(input) {
                
        // API配置
        const API_KEY = 'd476facf136de751a582b5df';
        const API_URL = 'https://v6.exchangerate-api.com/v6/';
        
        // DOM元素
        const amountInput = document.getElementById('amount');
        const fromCurrencySelect = document.getElementById('from-currency');
        const toCurrencySelect = document.getElementById('to-currency');
        const convertBtn = document.getElementById('convert-btn');
        const swapBtn = document.getElementById('swap-btn');
        const resultDiv = document.getElementById('result');
        const resultAmountDiv = document.getElementById('result-amount');
        const exchangeRateDiv = document.getElementById('exchange-rate');
        const lastUpdatedDiv = document.getElementById('last-updated');
        const loadingDiv = document.getElementById('loading');
        const errorMessageDiv = document.getElementById('error-message');
        const currencyChips = document.querySelectorAll('.currency-chip');
        
        // 货币数据
        let currencies = {};
        let exchangeRates = {};
        let lastUpdated = null;
        
        // 初始化
        window.addEventListener('DOMContentLoaded', () => {
            // 获取货币数据
            fetchCurrencies();
            
            // 添加事件监听器
            convertBtn.addEventListener('click', convertCurrency);
            swapBtn.addEventListener('click', swapCurrencies);
            currencyChips.forEach(chip => {
                chip.addEventListener('click', () => {
                    // 使用Select2的方法设置值
                    $('#to-currency').val(chip.dataset.code).trigger('change');
                    convertCurrency();
                });
            });
        });
        
        // 获取可用货币列表
        async function fetchCurrencies() {
            showLoading(true);
            showError(false);
            
            try {
                const response = await fetch(`${API_URL}${API_KEY}/latest/USD`);
                const data = await response.json();
                
                if (data.result === 'success') {
                    // 保存汇率数据
                    exchangeRates = data.conversion_rates;
                    lastUpdated = new Date(data.time_last_update_unix * 1000);
                    
                    // 创建货币列表
                    const currencyCodes = Object.keys(exchangeRates);
                    
                    // 货币名称映射（部分常用货币）
                    const currencyNames = {
                        USD: '美元',
                        EUR: '欧元',
                        JPY: '日元',
                        GBP: '英镑',
                        AUD: '澳元',
                        CAD: '加元',
                        CHF: '瑞士法郎',
                        CNY: '人民币',
                        HKD: '港币',
                        NZD: '新西兰元',
                        SEK: '瑞典克朗',
                        KRW: '韩元',
                        SGD: '新加坡元',
                        NOK: '挪威克朗',
                        MXN: '墨西哥比索',
                        INR: '印度卢比',
                        RUB: '俄罗斯卢布',
                        ZAR: '南非兰特',
                        TRY: '土耳其里拉',
                        BRL: '巴西雷亚尔',
                        TWD: '新台币',
                        DKK: '丹麦克朗',
                        PLN: '波兰兹罗提',
                        THB: '泰铢',
                        IDR: '印尼盾',
                        MYR: '马来西亚林吉特',
                        PHP: '菲律宾比索'
                    };
                    
                    // 填充选择框
                    currencyCodes.forEach(code => {
                        const name = currencyNames[code] ? `${currencyNames[code]} (${code})` : code;
                        currencies[code] = name;
                        
                        const fromOption = document.createElement('option');
                        fromOption.value = code;
                        fromOption.textContent = name;
                        fromCurrencySelect.appendChild(fromOption);
                        
                        const toOption = document.createElement('option');
                        toOption.value = code;
                        toOption.textContent = name;
                        toCurrencySelect.appendChild(toOption);
                    });
                    
                    // 初始化Select2
                    $('#from-currency, #to-currency').select2({
                        placeholder: '搜索货币...',
                        allowClear: true,
                        matcher: matchCustom
                    });
                    
                    // 设置默认值
                    $('#from-currency').val('USD').trigger('change');
                    $('#to-currency').val('CNY').trigger('change');
                    
                    // 添加Select2事件监听器
                    $('#from-currency, #to-currency').on('change', function() {
                        convertCurrency();
                    });
                    
                    // 执行初始转换
                    convertCurrency();
                } else {
                    showError(`API错误: ${data.error_type}`);
                }
            } catch (error) {
                showError(`无法获取货币数据: ${error.message}`);
            } finally {
                showLoading(false);
            }
        }
        
        // 转换货币
        function convertCurrency() {
            const amount = parseFloat(amountInput.value);
            const fromCurrency = $('#from-currency').val();
            const toCurrency = $('#to-currency').val();
            
            if (isNaN(amount) || amount <= 0) {
                showError('请输入有效的金额');
                return;
            }
            
            if (!exchangeRates[fromCurrency] || !exchangeRates[toCurrency]) {
                showError('无效的货币代码');
                return;
            }
            
            showError(false);
            
            // 计算转换率
            const rate = exchangeRates[toCurrency] / exchangeRates[fromCurrency];
            const convertedAmount = amount * rate;
            
            // 显示结果
            resultAmountDiv.textContent = `${amount.toFixed(2)} ${fromCurrency} = ${convertedAmount.toFixed(2)} ${toCurrency}`;
            exchangeRateDiv.textContent = `1 ${fromCurrency} = ${rate.toFixed(6)} ${toCurrency}`;
            lastUpdatedDiv.textContent = `最后更新: ${formatDate(lastUpdated)}`;
            resultDiv.style.display = 'block';
        }
        
        // 交换货币
        function swapCurrencies() {
            const temp = $('#from-currency').val();
            $('#from-currency').val($('#to-currency').val()).trigger('change');
            $('#to-currency').val(temp).trigger('change');
            convertCurrency();
        }
        
        // 自定义匹配函数，用于模糊搜索
        function matchCustom(params, data) {
            // 如果没有搜索词，返回所有数据
            if ($.trim(params.term) === '') {
                return data;
            }
            
            // 不搜索未定义或null的数据
            if (typeof data.text === 'undefined') {
                return null;
            }
            
            // 转换为小写进行比较
            const term = params.term.toLowerCase();
            const text = data.text.toLowerCase();
            
            // 检查搜索词是否包含在数据中
            if (text.indexOf(term) > -1) {
                return data;
            }
            
            // 如果没有匹配，返回null
            return null;
        }
        
        // 显示/隐藏加载指示器
        function showLoading(show) {
            loadingDiv.style.display = show ? 'block' : 'none';
        }
        
        // 显示/隐藏错误消息
        function showError(message) {
            if (message) {
                errorMessageDiv.textContent = message;
                errorMessageDiv.style.display = 'block';
            } else {
                errorMessageDiv.style.display = 'none';
            }
        }
        
        // 格式化日期
        function formatDate(date) {
            if (!date) return '';
            return date.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
    
                return input;
            }

            displayResult(result) {
                document.getElementById('resultContent').textContent = result;
            }

            clear() {
                document.getElementById('input').value = '';
                document.getElementById('resultContent').textContent = '处理结果将在这里显示...';
            }

            copyResult() {
                const result = document.getElementById('resultContent').textContent;
                if (result && result !== '处理结果将在这里显示...') {
                    ToolUtils.copyToClipboard(result);
                } else {
                    ToolUtils.showToast('没有可复制的内容', 'warning');
                }
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            new ToolApp();
        });
    </script>
</body>
</html>
